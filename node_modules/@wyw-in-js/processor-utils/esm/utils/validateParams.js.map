{"version":3,"file":"validateParams.js","names":["isValidParams","params","constraints","length","Math","max","i","undefined","constraint","Array","isArray","every","c","validateParams","messageOrError","Error"],"sources":["../../src/utils/validateParams.ts"],"sourcesContent":["import type { Param, Params } from '../types';\n\ntype ParamName = Param[0];\ntype ParamConstraint = ParamName | [...ParamName[]] | '*';\n\nexport type ParamConstraints =\n  | [...ParamConstraint[]]\n  | [...ParamConstraint[], '...'];\n\n// ParamMapping maps each ParamName to its corresponding Param type.\ntype ParamMapping = {\n  [K in ParamName]: Extract<Param, readonly [K, ...unknown[]]>; // For each ParamName K, extract the corresponding Param type.\n};\n\n// GetParamByName returns the Param type based on the input type T.\ntype GetParamByName<T> = T extends '*'\n  ? Param // If T is '*', return Param type.\n  : T extends keyof ParamMapping // If T is a key in ParamMapping (i.e., a ParamName).\n  ? ParamMapping[T] // Return the corresponding Param type from ParamMapping.\n  : T extends Array<infer TNames> // If T is an array of names.\n  ? TNames extends ParamName // If TNames is a ParamName.\n    ? Extract<Param, readonly [TNames, ...unknown[]]> // Return the corresponding Param type.\n    : never // If TNames is not a ParamName, return never.\n  : never; // If T is none of the above, return never.\n\n// MapParams iteratively maps the input ParamConstraints to their corresponding Param types.\nexport type MapParams<\n  TNames extends ParamConstraints,\n  TRes extends Param[] = [],\n> = TNames extends [infer THead, ...infer TTail] // If TNames is a non-empty tuple.\n  ? THead extends '...' // If the first element in the tuple is '...'.\n    ? [...TRes, ...Params] // Append all Params to the result tuple.\n    : MapParams<\n        Extract<TTail, ParamConstraints>, // Extract the remaining ParamConstraints.\n        [...TRes, GetParamByName<Extract<THead, ParamName | '*' | ParamName[]>>] // Append the mapped Param to the result tuple and recurse.\n      >\n  : TRes; // If TNames is an empty tuple, return the result tuple.\n\nexport function isValidParams<T extends ParamConstraints>(\n  params: Params,\n  constraints: T\n): params is MapParams<T> {\n  const length = Math.max(params.length, constraints.length);\n  for (let i = 0; i < length; i++) {\n    if (params[i] === undefined || constraints[i] === undefined) {\n      return false;\n    }\n\n    const constraint = constraints[i];\n    if (constraint === '...') {\n      return true;\n    }\n\n    if (constraint === '*') {\n      if (params[i] === undefined) {\n        return false;\n      }\n    } else if (Array.isArray(constraint)) {\n      if (constraint.every((c) => c !== params[i]?.[0])) {\n        return false;\n      }\n    } else if (constraint !== params[i]?.[0]) {\n      return false;\n    }\n  }\n\n  return true;\n}\n\nexport function validateParams<T extends ParamConstraints>(\n  params: Params,\n  constraints: T,\n  messageOrError: unknown\n): asserts params is MapParams<T> {\n  if (!isValidParams(params, constraints)) {\n    if (typeof messageOrError === 'string') {\n      throw new Error(messageOrError);\n    }\n\n    throw messageOrError;\n  }\n}\n"],"mappings":"AASA;;AAKA;;AASW;;AAEX;;AAWU;;AAEV,OAAO,SAASA,aAAaA,CAC3BC,MAAc,EACdC,WAAc,EACU;EACxB,MAAMC,MAAM,GAAGC,IAAI,CAACC,GAAG,CAACJ,MAAM,CAACE,MAAM,EAAED,WAAW,CAACC,MAAM,CAAC;EAC1D,KAAK,IAAIG,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGH,MAAM,EAAEG,CAAC,EAAE,EAAE;IAC/B,IAAIL,MAAM,CAACK,CAAC,CAAC,KAAKC,SAAS,IAAIL,WAAW,CAACI,CAAC,CAAC,KAAKC,SAAS,EAAE;MAC3D,OAAO,KAAK;IACd;IAEA,MAAMC,UAAU,GAAGN,WAAW,CAACI,CAAC,CAAC;IACjC,IAAIE,UAAU,KAAK,KAAK,EAAE;MACxB,OAAO,IAAI;IACb;IAEA,IAAIA,UAAU,KAAK,GAAG,EAAE;MACtB,IAAIP,MAAM,CAACK,CAAC,CAAC,KAAKC,SAAS,EAAE;QAC3B,OAAO,KAAK;MACd;IACF,CAAC,MAAM,IAAIE,KAAK,CAACC,OAAO,CAACF,UAAU,CAAC,EAAE;MACpC,IAAIA,UAAU,CAACG,KAAK,CAAEC,CAAC,IAAKA,CAAC,KAAKX,MAAM,CAACK,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,EAAE;QACjD,OAAO,KAAK;MACd;IACF,CAAC,MAAM,IAAIE,UAAU,KAAKP,MAAM,CAACK,CAAC,CAAC,GAAG,CAAC,CAAC,EAAE;MACxC,OAAO,KAAK;IACd;EACF;EAEA,OAAO,IAAI;AACb;AAEA,OAAO,SAASO,cAAcA,CAC5BZ,MAAc,EACdC,WAAc,EACdY,cAAuB,EACS;EAChC,IAAI,CAACd,aAAa,CAACC,MAAM,EAAEC,WAAW,CAAC,EAAE;IACvC,IAAI,OAAOY,cAAc,KAAK,QAAQ,EAAE;MACtC,MAAM,IAAIC,KAAK,CAACD,cAAc,CAAC;IACjC;IAEA,MAAMA,cAAc;EACtB;AACF"}